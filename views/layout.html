<!--
 * @Author: xinyuHu hxyrkcy@outlook.com
 * @Date: 2025-11-11 17:49:31
 * @LastEditors: xinyuHu hxyrkcy@outlook.com
 * @LastEditTime: 2025-12-04 12:38:19
 * @FilePath: \wenaili\views\layout.html
 * @Description: 这是默认设置,请设置`customMade`, 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE
-->
{# Automatically extends the right outer layout and also handles AJAX siutations #}
{% extends data.outerLayout %}
{% import 'fragments/footer.html' as footer %} {# 引入底部 #}
{% import 'fragments/header.html' as header %} {# 引入头部 #}
{% set defaultTitle = '物流货代企业运营专家 - 奈李信息技术' %}
{% set defaultDescription = '专业的物流货代公司市场部及技术部代运营服务提供商，助力货代企业提升品牌影响力与业务增长。提供货代网站建设、SEO优化、数据分析、数字化AI工具等服务，让您的货代企业在竞争中脱颖而出。' %}
{% set defaultKeywords = '物流货代,货代运营,市场部代运营,技术部代运营,物流营销,货代网站建设,货代SEO优化,货代数据分析,数字化AI工具,物流货代品牌建设' %}
{% set inferredTitle = data.piece.title or data.page.title %}
{% set seoTitle = data.piece.seoTitle or data.page.seoTitle or inferredTitle or defaultTitle %}
{% set seoDescription = data.piece.seoDescription or data.page.seoDescription or defaultDescription %}
{% set seoKeywords = data.piece.seoKeywords or data.page.seoKeywords or defaultKeywords %}
{% block title %}
  {{ seoTitle }}
  {% if not seoTitle %}
    {{ apos.log('Looks like you forgot to override the title block in a template that does not have access to an Apostrophe page or piece.') }}
  {% endif %}
{% endblock %}

{% block extraHead %}
  {{ super() }}
  <meta name="description" content="{{ seoDescription }}">
  <meta name="keywords" content="{{ seoKeywords }}">
  <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
      crossorigin="anonymous"
    />


    {% if data.global.analytics %}
    {# 百度站长平台验证 #}
    {% if data.global.analytics.baiduSiteVerification %}
      <meta name="baidu-site-verification" content="{{ data.global.analytics.baiduSiteVerification }}">
    {% endif %}
    {# Google Analytics #}
      {% if data.global.analytics?.googleAnalytics %}
      <script async src="https://www.googletagmanager.com/gtag/js?id={{ data.global.analytics.googleAnalytics }}"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', '{{ data.global.analytics.googleAnalytics }}');
      </script>
      {% endif %}
      {% if data.global.analytics.googleAnalytics4 %}
  <!-- Google Analytics 4 -->
      <script async src="https://www.googletagmanager.com/gtag/js?id={{ data.global.analytics.googleAnalytics4 }}"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', '{{ data.global.analytics.googleAnalytics4 }}');
      </script>
    {% endif %}
    {# 百度统计 #}
    {% if data.global.analytics.baiduAnalytics %}
      <script>
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?{{ data.global.analytics.baiduAnalytics }}";
          var s = document.getElementsByTagName("script")[0]; 
          s.parentNode.insertBefore(hm, s);
        })();
      </script>
    {% endif %}
  {% if data.global.analytics.customHeadCode %}
  {{ data.global.analytics.customHeadCode | safe }}
  {% endif %}
{% endif %}
{% endblock %}

{% block beforeMain %}  


   
   

<div class="bp-wrapper">
  {% render header.header(data) %}
  <main class="">
{% endblock %}

{% block main %}
  {#
    Usually, your page templates in the @apostrophecms/pages module will override
    this block. It is safe to assume this is where your page-specific content
    should go.
  #}
{% endblock %}
{% block afterMain %}
  </main>
  {% render footer.footer(data) %}

  {# 悬浮侧边栏 - 微信二维码 & 联系方式 #}
  {% if data.global.wechatQrCode %}
  <div class="fixed right-0 top-1/2 -translate-y-1/2 z-40 flex flex-col items-end gap-3" id="floating-sidebar">
    {# 微信二维码入口 #}
    <div class="group relative">
      <button
        type="button"
        aria-label="查看微信二维码"
        class="w-12 h-12 rounded-l-xl bg-green-500 text-white flex items-center justify-center shadow-lg hover:bg-green-600 transition-all duration-300 hover:w-14"
        data-qr-trigger
      >
        <i class="fa-brands fa-weixin text-xl"></i>
      </button>
      {# Hover 展开面板 #}
      <div class="absolute right-full top-1/2 -translate-y-1/2 mr-3 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 pointer-events-none group-hover:pointer-events-auto">
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl border border-gray-100 dark:border-gray-700 p-4 w-52">
          <div class="text-center">
            <p class="text-sm font-medium text-gray-700 dark:text-gray-200 mb-3">微信扫码联系我们</p>
            <div class="w-40 h-40 mx-auto rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700">
              {% area data.global, 'wechatQrCode' %}
            </div>
            <p class="text-xs text-gray-400 dark:text-gray-500 mt-2">扫一扫，添加微信</p>
          </div>
          {# 小三角箭头 #}
          <div class="absolute right-0 top-1/2 -translate-y-1/2 translate-x-full w-0 h-0 border-t-8 border-b-8 border-l-8 border-transparent border-l-white dark:border-l-gray-800"></div>
        </div>
      </div>
    </div>

    {# 电话快捷入口 #}
    {% if data.global.phone %}
    <div class="group relative">
      <a
        href="tel:{{ data.global.phone }}"
        aria-label="拨打电话"
        class="w-12 h-12 rounded-l-xl bg-blue-600 text-white flex items-center justify-center shadow-lg hover:bg-blue-700 transition-all duration-300 hover:w-14"
      >
        <i class="fa-solid fa-phone text-lg"></i>
      </a>
      <div class="absolute right-full top-1/2 -translate-y-1/2 mr-3 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 pointer-events-none group-hover:pointer-events-auto">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-100 dark:border-gray-700 px-4 py-2.5 whitespace-nowrap">
          <span class="text-sm text-gray-700 dark:text-gray-200">{{ data.global.phone }}</span>
          <div class="absolute right-0 top-1/2 -translate-y-1/2 translate-x-full w-0 h-0 border-t-6 border-b-6 border-l-6 border-transparent border-l-white dark:border-l-gray-800"></div>
        </div>
      </div>
    </div>
    {% endif %}
  </div>

  {# 二维码弹窗遮罩（移动端点击触发） #}
  <div
    id="qr-modal"
    class="fixed inset-0 z-50 hidden items-center justify-center bg-black/60 backdrop-blur-sm"
    role="dialog"
    aria-modal="true"
    aria-label="微信二维码"
  >
    <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl p-6 mx-4 max-w-xs w-full text-center relative animate-fade-in">
      <button
        type="button"
        class="absolute top-3 right-3 w-8 h-8 rounded-full bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600 flex items-center justify-center transition-colors"
        data-qr-close
        aria-label="关闭"
      >
        <i class="fa-solid fa-xmark"></i>
      </button>
      <div class="mb-3">
        <div class="w-16 h-16 mx-auto rounded-full bg-green-50 dark:bg-green-500/10 flex items-center justify-center mb-3">
          <i class="fa-brands fa-weixin text-3xl text-green-500"></i>
        </div>
        <h3 class="text-lg font-semibold text-gray-800 dark:text-gray-100">微信扫码联系</h3>
        <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">扫描下方二维码添加微信</p>
      </div>
      <div class="w-48 h-48 mx-auto rounded-xl overflow-hidden bg-gray-50 dark:bg-gray-700">
        {% area data.global, 'wechatQrCode' %}
      </div>
    </div>
  </div>
  {% endif %}

  <button
    id="back-to-top-button"
    type="button"
    aria-label="返回顶部"
    class="fixed bottom-8 right-8 z-50 w-12 h-12 rounded-full bg-blue-600 text-white flex items-center justify-center shadow-lg hover:bg-blue-700 transition-all duration-300 opacity-0 translate-y-4 pointer-events-none focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-blue-500"
  >
    <i class="fa-solid fa-arrow-up"></i>
  </button>
</div>{# Close .bp-wrapper #}
<script>
  (function () {
    const btn = document.getElementById('back-to-top-button');
    if (!btn) {
      return;
    }
    const threshold = 320;
    function toggleButton() {
      const shouldShow = window.scrollY > threshold;
      if (shouldShow) {
        btn.classList.remove('opacity-0', 'translate-y-4', 'pointer-events-none');
      } else {
        btn.classList.add('opacity-0', 'translate-y-4', 'pointer-events-none');
      }
    }
    function scrollToTop() {
      window.scrollTo({
        top: 0,
        behavior: 'smooth'
      });
    }
    btn.addEventListener('click', scrollToTop);
    window.addEventListener('scroll', toggleButton, { passive: true });
    toggleButton();
  })();
</script>
<script>
  // 二维码弹窗控制（移动端点击打开）
  (function () {
    const triggers = document.querySelectorAll('[data-qr-trigger]');
    const modal = document.getElementById('qr-modal');
    const closeBtns = document.querySelectorAll('[data-qr-close]');
    if (!modal || !triggers.length) return;

    function openModal() {
      if (window.innerWidth < 768) {
        modal.classList.remove('hidden');
        modal.classList.add('flex');
        document.body.classList.add('overflow-hidden');
      }
    }
    function closeModal() {
      modal.classList.add('hidden');
      modal.classList.remove('flex');
      document.body.classList.remove('overflow-hidden');
    }

    triggers.forEach(function (btn) { btn.addEventListener('click', openModal); });
    closeBtns.forEach(function (btn) { btn.addEventListener('click', closeModal); });
    modal.addEventListener('click', function (e) {
      if (e.target === modal) closeModal();
    });
    document.addEventListener('keydown', function (e) {
      if (e.key === 'Escape') closeModal();
    });
  })();
</script>
{% endblock %}
